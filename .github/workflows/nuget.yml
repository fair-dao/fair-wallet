# This workflow will build a .NET project
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-net

name: fair

on:
  push:
    branches: [ "dev" ]
  pull_request:
    branches: [ "dev" ]

jobs:
  build:

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v3
    - name: Setup .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: 8.0.x

    - uses: actions/setup-java@v2
      with:
          distribution: 'microsoft'
          java-version: '11'

    - name: Install MAUI Workloads & pack
      run: |
          #dotnet workload install android --ignore-failed-sources
          dotnet workload install maui --ignore-failed-sources
          dotnet pack .\src\wallet\fair.extensions.wallet\ -o .\out /p:Version=8.4.$env:GITHUB_RUN_NUMBER
          dotnet nuget push .\out\*.nupkg --api-key ${{ secrets.NUGET_API_KEY }} --source https://api.nuget.org/v3/index.json
    #- name: Restore Dependencies
    #  run: dotnet restore your-project.csproj

    #- name: Publish MAUI Android
    #  run: dotnet publish -f:net7.0-android -c:Release /p:AndroidSigningKeyPass=${{secrets.keystorepassword}} /p:AndroidSigningStorePass=${{secrets.keystorepassword}}

    #- name: Upload Android Artifact
    #  uses: actions/upload-artifact@v2.3.1
    #  with:
    #      name: android-ci-build
    #      path: YourProject/bin/Release/net7.0-android/*Signed.apk*
